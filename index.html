<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Javanese Mint</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <style>
    body { background: #0f0f0f; color: white; font-family: sans-serif; text-align: center; padding: 50px; }
    button { padding: 10px 20px; font-size: 16px; background: #7c3aed; color: white; border: none; border-radius: 8px; cursor: pointer; }
    button:disabled { background: gray; }
  </style>
</head>
<body>
  <h1>Mint Your Javanese NFT</h1>
  <p>Price: <strong>1 MON</strong></p>
  <button id="mintButton">Connect Wallet</button>
  <p id="status"></p>

  <script>
    const contractAddress = "0x695343E161DC19274062d24de89e81fed280e449";
    const abi = [
      "function mint(address to, uint256 amount) external",
      "function balanceOf(address owner) view returns (uint256)"
    ];

    const price = ethers.utils.parseEther("1.0");
    const mintAmount = 1;

    let signer, contract;

    const button = document.getElementById("mintButton");
    const status = document.getElementById("status");

    button.onclick = async () => {
      if (!window.ethereum) return alert("Install MetaMask!");

      const provider = new ethers.providers.Web3Provider(window.ethereum);
      await provider.send("eth_requestAccounts", []);
      signer = provider.getSigner();

      const userAddress = await signer.getAddress();
      contract = new ethers.Contract(contractAddress, abi, signer);

      const alreadyMinted = await contract.balanceOf(userAddress);
      if (alreadyMinted.toString() !== "0") {
        status.innerText = "❌ You already minted.";
        button.disabled = true;
        return;
      }

      try {
        status.innerText = "⏳ Minting...";
        const tx = await contract.mint(userAddress, mintAmount, { value: price });
        await tx.wait();
        status.innerText = "✅ Mint success!";
        button.disabled = true;
      } catch (e) {
        console.error(e);
        status.innerText = "❌ Transaction failed.";
      }
    };
  </script>
</body>
</html>
